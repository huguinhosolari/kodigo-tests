<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Validaci√≥n de Pedido con PropTypes</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

  <div class="container py-5">
    <h2 class="mb-4 text-center">üõí Validaci√≥n de Pedido usando Clases + PropTypes</h2>

    <div class="card p-4 shadow-sm">
      <h4 class="mb-3">Resultado:</h4>
      <p id="resultado" class="fs-5"></p>
      <pre class="bg-dark text-white p-3 rounded"><code id="objetoPreview"></code></pre>
    </div>
  </div>

  <script>
    // üß± PropTypes simulados
    const PropTypes = {
      string: val => typeof val === 'string',
      number: val => typeof val === 'number',

      shape: function (schema) {
        return function (obj) {
          if (typeof obj !== 'object' || obj === null) return false;
          return Object.keys(schema).every(key => schema[key](obj[key]));
        };
      },

      arrayOf: function (validator) {
        return function (arr) {
          return Array.isArray(arr) && arr.every(validator);
        };
      }
    };

    // üß± Clases
    class Cliente {
      constructor(nombre, correo) {
        this.nombre = nombre;
        this.correo = correo;
      }
    }

    class Producto {
      constructor(nombre, precio) {
        this.nombre = nombre;
        this.precio = precio;
      }
    }

    class Pedido {
      constructor(cliente, productos = []) {
        this.cliente = cliente;
        this.productos = productos;
      }
    }

    // üß± Esquemas de validaci√≥n
    const esquemaCliente = PropTypes.shape({
      nombre: PropTypes.string,
      correo: PropTypes.string
    });

    const esquemaProducto = PropTypes.shape({
      nombre: PropTypes.string,
      precio: PropTypes.number
    });

    const esquemaPedido = PropTypes.shape({
      cliente: esquemaCliente,
      productos: PropTypes.arrayOf(esquemaProducto)
    });



    // üß™ Datos de prueba
    const pedido1 = new Pedido(
      new Cliente("Mar√≠a", "maria@gmail.com"),
      [
        new Producto("Mouse", 15),
        new Producto("Teclado", 30)
      ]
    );

    const pedido2 = new Pedido(
      new Cliente("Luis", "correo-malo"),
      [
        new Producto("Monitor", "cincuenta"), // ERROR: precio no es number
        new Cliente ("Mario", "fake@nismsms.com") //ERROR
      ]
    );

    // ‚úÖ Cambi√° entre pedido1 y pedido2 para ver qu√© pasa
    const pedidoActual = pedido2;

    const esValido = esquemaPedido(pedidoActual);
    const resultadoTexto = esValido
      ? "‚úÖ Pedido v√°lido: todos los datos son correctos."
      : "‚ùå Error: el pedido no cumple con el esquema.";

    document.getElementById("resultado").textContent = resultadoTexto;
    document.getElementById("objetoPreview").textContent = JSON.stringify(pedidoActual, null, 2);
  </script>

</body>
</html>
